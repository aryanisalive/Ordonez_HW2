<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ride Platform Starter</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="app-header">
    <h1>Ride Platform</h1>
    <nav class="tabs" role="tablist" aria-label="Main sections">
      <button class="tab is-active" data-tab="booking" role="tab" aria-selected="true">Booking</button>
      <button class="tab" data-tab="history" role="tab" aria-selected="false">Ride History</button>
      <button class="tab" data-tab="finance" role="tab" aria-selected="false">Finance</button>
      <button class="tab" data-tab="data" role="tab" aria-selected="false">Data</button>
      <button class="tab" data-tab="settings" role="tab" aria-selected="false">Settings</button>
      <!-- NEW -->
      <button class="tab" data-tab="admin" role="tab" aria-selected="false">Admin</button>
    </nav>
  </header>

  <main>
    <!-- BOOKING -->
    <section id="booking" class="panel is-active" role="tabpanel" aria-labelledby="booking-tab">
      <div class="card">
        <h2>New Ride</h2>
        <form id="bookingForm" class="grid" autocomplete="off">
          <div class="field">
            <label for="userName">User</label>
            <input id="userName" name="userName" placeholder="e.g., Alice Johnson" required />
          </div>

          <div class="field">
            <label for="driverName">Driver</label>
            <input id="driverName" name="driverName" placeholder="e.g., Samir Patel" required />
          </div>

          <div class="field">
            <label for="pickup">Pickup Location</label>
            <input id="pickup" name="pickup" placeholder="e.g., 123 Main St" required />
          </div>

          <div class="field">
            <label for="dropoff">Dropoff Location</label>
            <input id="dropoff" name="dropoff" placeholder="e.g., 500 Market Ave" required />
          </div>

          <div class="field">
            <label for="category">Category</label>
            <select id="category" name="category" required>
              <option value="">Select…</option>
              <option value="Standard">Standard</option>
              <option value="XL">XL</option>
              <option value="Executive">Executive</option>
            </select>
          </div>

          <div class="field">
            <label for="paymentMethod">Payment</label>
            <select id="paymentMethod" name="paymentMethod" required>
              <option value="">Select…</option>
              <option value="Card">Card</option>
              <option value="Cash">Cash</option>
              <option value="Wallet">Wallet</option>
            </select>
          </div>

          <div class="field">
            <label for="rideTime">Time</label>
            <input id="rideTime" name="rideTime" type="datetime-local" required />
          </div>

          <div class="field">
            <label for="basePrice">Base Price ($)</label>
            <input id="basePrice" name="basePrice" type="number" min="0" step="0.01" placeholder="e.g., 18.50" required />
          </div>

          <div class="field">
            <label for="notes">Notes <span class="hint">(optional)</span></label>
            <input id="notes" name="notes" placeholder="e.g., airport pickup" />
          </div>

          <div class="summary">
            <div class="summary-row">
              <span>Tax (<span id="taxRateLabel"></span>):</span>
              <strong id="taxAmount">$0.00</strong>
            </div>
            <div class="summary-row total">
              <span>Total:</span>
              <strong id="totalAmount">$0.00</strong>
            </div>
          </div>

          <div class="actions">
	    <button type="button" class="btn ghost" id="simulateRide">Simulate Ride</button>
            <button type="submit" class="btn primary">Book Ride</button>
            <button type="reset" class="btn ghost" id="resetBooking">Reset</button>
          </div>
        </form>
      </div>
    </section>

    <!-- HISTORY -->
    <section id="history" class="panel" role="tabpanel" aria-labelledby="history-tab">
      <div class="card">
        <div class="row-split">
          <h2>Ride History</h2>
          <div class="filters">
            <input id="filterUser" placeholder="Filter by user…" />
            <input id="filterDriver" placeholder="Filter by driver…" />
            <select id="filterCategory">
              <option value="">All categories</option>
              <option>Standard</option>
              <option>XL</option>
              <option>Executive</option>
            </select>
	    <button id="clearFilters" class="btn ghost">Clear</button>
	    <button id="clearHistory" class="btn danger">Clear History</button>
          </div>
        </div>

        <div class="table-wrap">
          <table id="ridesTable" class="table">
            <thead>
              <tr>
                <th>Time</th>
                <th>User</th>
                <th>Driver</th>
                <th>From → To</th>
                <th>Category</th>
                <th>Payment</th>
                <th>Base</th>
                <th>Tax</th>
                <th>Total</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody><!-- rows injected --></tbody>
          </table>
        </div>
      </div>
    </section>

        <!-- --- ADMIN --- -->
    <section id="admin" class="panel" role="tabpanel" aria-labelledby="admin-tab">
      <div class="card">
        <h2>Admin</h2>
        <p class="muted">Create/init tables, browse a few rows, truncate data, and download SQL traces.</p>

        <div class="admin-grid">
          <div class="admin-actions inline">
            <button id="btn-create-tables" class="btn">Create Tables</button>
            <button id="btn-init-lookups" class="btn">Initialize Lookups</button>

            <label class="inline">
              <input class="muted" type="checkbox" id="admin-only-nonlookup" checked />
              Truncate only non-lookup tables
            </label>

            <button id="btn-truncate" class="btn danger">Delete Rows (Danger)</button>
          </div>

          <div class="admin-browse">
            <div class="row">
              <label for="admin-table">Browse table</label>
              <select id="admin-table">
                <option value="">Select a table…</option>
              </select>
              <label for="admin-limit">Limit</label>
              <input id="admin-limit" type="number" min="1" max="100" value="10" />
              <button id="btn-browse" class="btn">Browse 10</button>
            </div>
          </div>

          <div class="admin-traces">
            <div class="row">
              <button id="btn-dl-transaction" class="btn">Download transaction.sql</button>
              <button id="btn-dl-query" class="btn">Download query.sql</button>
              <button id="btn-clear-traces" class="btn ghost">Clear traces</button>
            </div>
          </div>
        </div>

        <div id="admin-output" class="console"></div>
      </div>
    </section>

    <!-- FINANCE -->
    <section id="finance" class="panel" role="tabpanel" aria-labelledby="finance-tab">
      <div class="card">
        <h2>Driver Payouts & Company Commission</h2>

        <div class="grid-two">
          <div>
            <h3>Outstanding Driver Payouts</h3>
            <div class="table-wrap">
              <table id="payoutTable" class="table">
                <thead>
                  <tr>
                    <th>Driver</th>
                    <th>Unpaid Rides</th>
                    <th>Amount Owed ($)</th>
                    <th></th>
                  </tr>
                </thead>
                <tbody><!-- injected --></tbody>
              </table>
            </div>
          </div>

          <div>
            <h3>Company Commission</h3>
            <div class="table-wrap">
              <table id="commissionTable" class="table">
                <thead>
                  <tr>
                    <th>Period</th>
                    <th>Rides</th>
                    <th>Commission ($)</th>
                    <th></th>
                  </tr>
                </thead>
                <tbody><!-- injected --></tbody>
              </table>
            </div>
          </div>
        </div>

        <div class="row-split mt">
          <div class="inline">
            <label for="payoutDriver">Pay Driver</label>
            <input id="payoutDriver" placeholder="Driver name…" />
            <button id="btnPayDriver" class="btn">Pay Selected</button>
          </div>

          <div class="inline">
            <label for="commissionPeriod">Run Commission</label>
            <select id="commissionPeriod">
              <option value="today">Today</option>
              <option value="7d">Last 7 days</option>
              <option value="30d">Last 30 days</option>
              <option value="all">All time</option>
            </select>
            <button id="btnRunCommission" class="btn">Calculate</button>
          </div>
        </div>
      </div>
    
        <hr class="mt" />
        <h3>Reports (server)</h3>
        <div class="grid-two">
          <div>
            <div class="inline">
              <label>Commission by Day &amp; Category</label>
              <input id="r1Start" type="date" />
              <input id="r1End" type="date" />
              <button id="btnReportCommission" class="btn">Run</button>
            </div>
            <div class="table-wrap">
              <table id="tblReportCommission" class="table">
                <thead>
                  <tr>
                    <th>Day</th><th>Category</th><th>Rides</th><th>Base</th><th>Commission</th><th>Tax</th><th>Total</th>
                  </tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>
          </div>
          <div>
            <div class="inline">
              <label>Rides per Driver per Day</label>
              <input id="r2Start" type="date" />
              <input id="r2End" type="date" />
              <button id="btnReportRidesPerDriver" class="btn">Run</button>
            </div>
            <div class="table-wrap">
              <table id="tblReportRidesPerDriver" class="table">
                <thead>
                  <tr>
                    <th>Day</th><th>Driver</th><th>Rides</th><th>Gross</th>
                  </tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>
          </div>
        </div>

        <div class="mt">
          <div class="inline">
            <label>Outstanding Payouts</label>
            <input id="r3Start" type="date" />
            <input id="r3End" type="date" />
            <button id="btnReportOutstanding" class="btn">Run</button>
          </div>
          <div class="table-wrap">
            <table id="tblReportOutstanding" class="table">
              <thead>
                <tr>
                  <th>Driver</th><th>Rides</th><th>Owed</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
    </section>

    <!-- Data -->
    <section id="data" class="panel" role="tabpanel" aria-labelledby="data-tab">
      <div class="card">
        <h2>Server Data Overview</h2>
        <p class="muted">
          This tab shows users (riders), drivers, and their bank accounts as stored in PostgreSQL.
        </p>

        <div class="actions">
          <button id="btnLoadData" class="btn">Load Data from Server</button>
        </div>

        <!-- USERS-->
        <h3>Users (Riders)</h3>
        <div class="table-wrap">
          <table id="tblUsers" class="table">
            <thead>
              <tr>
                <th>user_id</th>
                <th>Name</th>
                <th>Email</th>
                <th>Phone</th>
              </tr>
            </thead>
            <tbody><!-- filled by JS--></tbody>
          </table>
        </div>

        <!-- DRIVERS-->
        <h3>Drivers</h3>
        <div class="table-wrap">
          <table id="tblDrivers" class="table">
            <thead>
              <tr>
                <th>driver_id</th>
                <th>Name</th>
                <th>Email</th>
                <th>Booked?</th>
              </tr>
            </thead>
            <tbody><!-- filled by JS--></tbody>
          </table>
        </div>

        <!-- USER BANK -->
        <h3>User Bank Accs</h3>
        <div class="table-wrap">
          <table id="tblUserBank" class="table">
            <thead>
              <tr>
                <th>user_id</th>
                <th>Name</th>
                <th>Email</th>
                <th>account_id</th>
                <th>Bank #</th>
                <th>Currency</th>
                <th>Status</th>
                <th>Balance</th>
              </tr>
            </thead>
            <tbody><!-- filled by JS--></tbody>
          </table>
        </div>


        <!-- Driver BANK -->
        <h3>Driver Bank Accs</h3>
        <div class="table-wrap">
          <table id="tblDriverBank" class="table">
            <thead>
              <tr>
                <th>driver_id</th>
                <th>user_id</th>
                <th>Name</th>
                <th>Email</th>
                <th>account_id</th>
                <th>Bank #</th>
                <th>Currency</th>
                <th>Status</th>
                <th>Balance</th>
              </tr>
            </thead>
            <tbody><!-- filled by JS--></tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- SETTINGS -->
    <section id="settings" class="panel" role="tabpanel" aria-labelledby="settings-tab">
      <div class="card">
        <h2>Settings</h2>
        <form id="settingsForm" class="grid">
          <div class="field">
            <label for="taxRate">Tax Rate (%)</label>
            <input id="taxRate" type="number" min="0" step="0.01" />
          </div>
          <div class="field">
            <label for="commissionRate">Company Commission (%)</label>
            <input id="commissionRate" type="number" min="0" step="0.01" />
          </div>
          <div class="actions">
            <button class="btn primary" type="submit">Save</button>
            <button class="btn ghost" type="button" id="resetRates">Reset to Defaults</button>
          </div>
        </form>
      </div>
    </section>
  </main>

  <footer class="app-footer">
    <small>Starter template • Replace storage with real API calls when ready.</small>
  </footer>

  <script src="app.js" defer></script>
</body>
</html>
